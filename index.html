<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calculate Area of Triangles and Polygons • area</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Calculate Area of Triangles and Polygons">
<meta property="og:description" content="Calculate the area of triangles and polygons using the shoelace 
 formula. Area may be signed, taking into account path orientation, or unsigned, 
 ignoring path orientation. The shoelace formula is described at 
 &lt;https://en.wikipedia.org/wiki/Shoelace_formula&gt; and its cross-product basis at
 &lt;http://www.cs.tufts.edu/comp/163/OrientationTests.pdf&gt;. ">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">area</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1.9004</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/hypertidy/area/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="area" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#area" class="anchor"></a>area</h1></div>
<!-- badges: start -->

<p>The goal of area is to calculate areas, allow control over how that happens, and illustrate how it works.</p>
<p>Very much work in progress.</p>
<p>Please, do not use this for your land surveying contract.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install the development version from <a href="https://github.com/">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="r"><span class="co"># install.packages("devtools")</span>
<span class="kw pkg">devtools</span><span class="kw ns">::</span><span class="fu">install_github</span>(<span class="st">"hypertidy/area"</span>)</pre></div>
</div>
<div id="straightforward-tools" class="section level2">
<h2 class="hasAnchor">
<a href="#straightforward-tools" class="anchor"></a>Straightforward tools</h2>
<p>The area package is written to allow easy to use calculations for developing packages. It’s similar to the <a href="https://CRAN.r-project.org/">traipse</a> package which was created to leverage the grouping mechanisms of the tidyverse for common tracking data calculations.</p>
<div class="sourceCode" id="cb2"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">area</span>)
<span class="fu"><a href="reference/polygon_area.html">polygon_area</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>),
                <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>)))
<span class="co">#&gt; [1] 1</span>

<span class="fu"><a href="reference/triangle_area.html">triangle_area</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>),
               <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>)))
<span class="co">#&gt; [1] 0.5 0.5</span></pre></div>
<p>There’s an inbuilt data set with a path of Tasmania’s outline.</p>
<div class="sourceCode" id="cb3"><pre class="r"><span class="no">index</span> <span class="kw">&lt;-</span> <span class="fl">4423</span> <span class="co">## explain later</span>
<span class="no">idx</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">tas</span>$<span class="no">S</span>[<span class="fl">1</span>], <span class="no">tas</span>$<span class="no">S</span>[<span class="fl">1</span>:<span class="no">index</span>,<span class="fl">2</span>], <span class="fl">1</span>)
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">tas</span>$<span class="no">P</span>[<span class="no">idx</span>, ], <span class="kw">type</span> <span class="kw">=</span> <span class="st">"l"</span>, <span class="kw">asp</span> <span class="kw">=</span> <span class="fl">1</span>)</pre></div>
<p><img src="reference/figures/README-tas-1.png" width="100%"></p>
<div class="sourceCode" id="cb4"><pre class="r"><span class="fu"><a href="reference/polygon_area.html">polygon_area</a></span>(<span class="no">tas</span>$<span class="no">P</span>[<span class="no">idx</span>, ])/<span class="fl">1e6</span>
<span class="co">#&gt; [1] 61672.74</span>

<span class="kw pkg">sf</span><span class="kw ns">::</span><span class="fu">st_area</span>(<span class="kw pkg">sf</span><span class="kw ns">::</span><span class="fu">st_polygon</span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="no">tas</span>$<span class="no">P</span>[<span class="no">idx</span>, ])))/<span class="fl">1e6</span>
<span class="co">#&gt; [1] 61672.74</span></pre></div>
<div class="sourceCode" id="cb5"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">area</span>)

<span class="no">calc_area</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">df</span>) {
 <span class="no">area</span> <span class="kw">&lt;-</span> <span class="no">df</span> <span class="kw">%&gt;%</span> <span class="fu">mutate</span>(<span class="kw">row</span> <span class="kw">=</span> <span class="fu">row_number</span>()) <span class="kw">%&gt;%</span>
  <span class="fu">group_by</span>(<span class="no">multipolygon_id</span>, <span class="no">polygon_id</span>, <span class="no">linestring_id</span>) <span class="kw">%&gt;%</span>
   <span class="fu">arrange</span>(<span class="no">row</span>) <span class="kw">%&gt;%</span>
  <span class="fu">summarize</span>(<span class="kw">area</span> <span class="kw">=</span> <span class="fu"><a href="reference/polygon_area.html">polygon_area</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="no">x</span>, <span class="no">y</span>))) <span class="kw">%&gt;%</span>
  <span class="fu">ungroup</span>() <span class="co">#%&gt;% </span>
  <span class="no">area</span> <span class="kw">%&gt;%</span>  <span class="fu">mutate</span>(<span class="kw">area</span> <span class="kw">=</span> <span class="no">area</span>,
                   <span class="kw">hole</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">1</span>, <span class="fl">1</span>)[(<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">pmax</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span>(<span class="no">multipolygon_id</span>)), <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span>(<span class="no">polygon_id</span>))) <span class="kw">==</span> <span class="fl">1</span>) + <span class="fl">1</span>])
}
<span class="no">xsf</span> <span class="kw">&lt;-</span> <span class="kw pkg">silicate</span><span class="kw ns">::</span><span class="no">inlandwaters</span>
<span class="no">df</span> <span class="kw">&lt;-</span> <span class="kw pkg">sfheaders</span><span class="kw ns">::</span><span class="fu">sf_to_df</span>(<span class="no">xsf</span>)
(<span class="no">mmarea</span> <span class="kw">&lt;-</span> <span class="fu">calc_area</span>(<span class="no">df</span>))
<span class="co">#&gt; # A tibble: 189 x 5</span>
<span class="co">#&gt;    multipolygon_id polygon_id linestring_id          area  hole</span>
<span class="co">#&gt;              &lt;dbl&gt;      &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt;  1               1          1             1   2203380098.     1</span>
<span class="co">#&gt;  2               2          1             1    103039733.     1</span>
<span class="co">#&gt;  3               3          1             1 750145539388.     1</span>
<span class="co">#&gt;  4               3          1             2    100909770.    -1</span>
<span class="co">#&gt;  5               3          1             3   2203380098.    -1</span>
<span class="co">#&gt;  6               3          1             4     45585186.    -1</span>
<span class="co">#&gt;  7               3          1             5     89780792.    -1</span>
<span class="co">#&gt;  8               3          1             6    110755146.    -1</span>
<span class="co">#&gt;  9               3          1             7     59287239.    -1</span>
<span class="co">#&gt; 10               3          1             8     66189369.    -1</span>
<span class="co">#&gt; # … with 179 more rows</span>
<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">mmarea</span>$<span class="no">area</span> * <span class="no">mmarea</span>$<span class="no">hole</span>)
<span class="co">#&gt; [1] 1.923706e+12</span>
<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="kw pkg">sf</span><span class="kw ns">::</span><span class="fu">st_area</span>(<span class="no">xsf</span>))
<span class="co">#&gt; 1.923706e+12 [m^2]</span></pre></div>
</div>
<div id="straightforward" class="section level2">
<h2 class="hasAnchor">
<a href="#straightforward" class="anchor"></a>Straightforward?</h2>
<p>Well - ha ha - we will need some ease of use here, and some speed ups - but we aren’t restricted to one in-memory format, we have the area of every component part to use as we wish (the grouping tells us about holes and multipolygons), we can tell the orientation of the polygon or triangle and get its area, and when we have the right tools we’ll only be using R and C++. Oh and we can calculate with triangles stored compactly.</p>
<div class="sourceCode" id="cb6"><pre class="r">(<span class="no">a</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/triangle_area.html">triangle_area</a></span>(<span class="no">mm_tri</span>$<span class="no">P</span>[<span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="no">mm_tri</span>$<span class="no">T</span>), ]))
<span class="co">#&gt;  [1] 0.03000 0.06900 0.03000 0.02000 0.05000 0.10000 0.05500 0.03000 0.03000</span>
<span class="co">#&gt; [10] 0.03000 0.03000 0.14550 0.05145 0.04500 0.11250 0.06250 0.06800</span>
<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">a</span>)
<span class="co">#&gt; [1] 0.95895</span>

<span class="co">## so we don't double count the hole</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">mmarea</span>$<span class="no">area</span>[<span class="no">mmarea</span>$<span class="no">hole</span> <span class="kw">&gt;</span> <span class="fl">0</span>]))
<span class="co">#&gt; [1] 1.952986e+12</span></pre></div>
<p>The key motivation here is <em>flexibility</em> and working with triangles.</p>
<p>Performance is compelling, compare silicate::tri_area() to this C++ version</p>
<div class="sourceCode" id="cb7"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">silicate</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'silicate'</span>
<span class="co">#&gt; The following objects are masked _by_ '.GlobalEnv':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     inlandwaters, minimal_mesh</span>
<span class="co">#&gt; The following object is masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     filter</span>
<span class="no">tas_tri</span> <span class="kw">&lt;-</span> <span class="kw pkg">RTriangle</span><span class="kw ns">::</span><span class="fu">triangulate</span>(<span class="no">tas</span>)
<span class="no">trxy</span> <span class="kw">&lt;-</span> <span class="no">tas_tri</span>$<span class="no">P</span>[<span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="no">tas_tri</span>$<span class="no">T</span>), ]
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span>(<span class="no">trxy</span>)
<span class="co">#&gt; [1] 18291     2</span>
<span class="kw pkg">rbenchmark</span><span class="kw ns">::</span><span class="fu">benchmark</span>(<span class="kw">R</span> <span class="kw">=</span> {<span class="no">a</span> <span class="kw">&lt;-</span> <span class="fu">tri_area</span>(<span class="no">trxy</span>)}, <span class="kw">cpp</span> <span class="kw">=</span> {<span class="no">b</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/triangle_area.html">triangle_area</a></span>(<span class="no">trxy</span>)})
<span class="co">#&gt;   test replications elapsed relative user.self sys.self user.child sys.child</span>
<span class="co">#&gt; 2  cpp          100   0.064    1.000     0.036    0.028          0         0</span>
<span class="co">#&gt; 1    R          100   0.292    4.562     0.259    0.032          0         0</span>
<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span>(<span class="no">a</span> - <span class="no">b</span>))
<span class="co">#&gt; [1] 0.0004653583</span>
<span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">a</span>), <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">b</span>)))
<span class="co">#&gt; [1] 61672735794</span></pre></div>
<hr>
</div>
<div id="code-of-conduct" class="section level2">
<h2 class="hasAnchor">
<a href="#code-of-conduct" class="anchor"></a>Code of Conduct</h2>
<p>Please note that the area project is released with a <a href="https://contributor-covenant.org/version/2/0/CODE_OF_CONDUCT.html">Contributor Code of Conduct</a>. By contributing to this project, you agree to abide by its terms.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/hypertidy/area/">https://​github.com/​hypertidy/​area/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/hypertidy/area/issues">https://​github.com/​hypertidy/​area/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></li>
</ul>
</div>
<div class="community">
<h2>Community</h2>
<ul class="list-unstyled">
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Michael Sumner <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-2471-7511" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://www.tidyverse.org/lifecycle/#experimental"><img src="https://img.shields.io/badge/lifecycle-experimental-orange.svg" alt="Lifecycle: experimental"></a></li>
<li><a href="https://github.com/hypertidy/area/actions"><img src="https://github.com/hypertidy/area/workflows/R-CMD-check/badge.svg" alt="R build status"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Michael Sumner.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
